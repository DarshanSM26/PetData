<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Checkout - VetPawtner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body { font-family:'Segoe UI',sans-serif; background:#f8f8f8; }
        .container { max-width:800px; margin-top:30px; }
        h2 { color:#5a3d2b; margin-bottom:20px; }
        .cart-item { display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid #ddd; }
        .cart-item:last-child { border-bottom:none; }
        .cart-total { text-align:right; font-weight:700; margin-top:20px; font-size:1.2rem; color:#ff6b35;}
        .btn-pay { background:linear-gradient(90deg,#ff6b35,#ff9472); color:#fff; border:none; border-radius:10px; padding:0.5rem 1.2rem; font-weight:700; }
        #popup-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); display:none; justify-content:center; align-items:center; z-index:9999;}
        #popup { background:#fff; border-radius:16px; width:90%; max-width:400px; padding:20px; text-align:center; transform:translateY(-50px); opacity:0; transition: all 0.3s ease; }
        #popup.show { transform:translateY(0); opacity:1; }
        #popup h3 { margin-bottom:15px; color:#5a3d2b; }
        #popup button { margin:10px; padding:0.5rem 1.2rem; border:none; border-radius:10px; font-weight:700; cursor:pointer; }
        #btn-confirm { background:linear-gradient(90deg,#ff6b35,#ff9472); color:#fff; }
        #btn-cancel { background:#ddd; color:#333; }
        .success-msg { color:green; font-weight:700; margin-top:20px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Your Cart</h2>
    <div id="cart-items"></div>
    <div class="cart-total" id="cart-total"></div>
    <div class="mt-4">
        <button class="btn-pay" id="btn-pay">Continue to Payment</button>
    </div>
    <div class="success-msg" id="success-msg"></div>
</div>

<!-- Razorpay-style popup -->
<div id="popup-overlay">
    <div id="popup">
        <h3>Confirm Payment</h3>
        <div id="popup-cart"></div>
        <div class="cart-total" id="popup-total"></div>
        <button id="btn-confirm">Pay Now</button>
        <button id="btn-cancel">Cancel</button>
    </div>
</div>

<script>
    // Fetch cart from localStorage
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    // Render cart items
    function renderCart(){
        const container = document.getElementById('cart-items');
        container.innerHTML = '';
        let total = 0;
        cart.forEach(item=>{
            const subtotal = item.price * item.quantity;
            total += subtotal;
            const div = document.createElement('div');
            div.className = 'cart-item';
            div.innerHTML = `<span>${item.product_name} x ${item.quantity}</span><span>₹${subtotal.toFixed(2)}</span>`;
            container.appendChild(div);
        });
        document.getElementById('cart-total').textContent = 'Total: ₹'+total.toFixed(2);
    }
    renderCart();

    // Payment popup
    const popupOverlay = document.getElementById('popup-overlay');
    const popup = document.getElementById('popup');
    const btnPay = document.getElementById('btn-pay');
    const btnConfirm = document.getElementById('btn-confirm');
    const btnCancel = document.getElementById('btn-cancel');
    const popupCart = document.getElementById('popup-cart');
    const popupTotal = document.getElementById('popup-total');
    const successMsg = document.getElementById('success-msg');

    btnPay.addEventListener('click', ()=>{
        if(cart.length===0){ alert('Your cart is empty!'); return; }

        // Render popup items
        popupCart.innerHTML='';
        let total=0;
        cart.forEach(item=>{
            const subtotal = item.price * item.quantity;
            total += subtotal;
            const div = document.createElement('div');
            div.style.display='flex';
            div.style.justifyContent='space-between';
            div.style.margin='5px 0';
            div.textContent = `${item.product_name} x ${item.quantity} = ₹${subtotal.toFixed(2)}`;
            popupCart.appendChild(div);
        });
        popupTotal.textContent = 'Total: ₹'+total.toFixed(2);

        // Show popup
        popupOverlay.style.display='flex';
        setTimeout(()=>{ popup.classList.add('show'); },10);
    });

    btnCancel.addEventListener('click', ()=>{
        popup.classList.remove('show');
        setTimeout(()=>{ popupOverlay.style.display='none'; },300);
    });

    btnConfirm.addEventListener('click', ()=>{
        // Simulate payment success
        popup.classList.remove('show');
        setTimeout(()=>{ popupOverlay.style.display='none'; },300);
        successMsg.textContent = 'Payment Successful! Thank you for your order.';
        localStorage.removeItem('cart');
        cart=[];
        document.getElementById('cart-items').innerHTML='';
        document.getElementById('cart-total').textContent='';
    });
</script>

</body>
</html>
